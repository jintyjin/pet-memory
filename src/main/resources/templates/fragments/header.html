<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head th:fragment="header">
  <meta charset="utf-8">
  <link th:href="@{/css/bootstrap.min.css}"
        href="../css/bootstrap.min.css" rel="stylesheet">
  <script th:src="@{/js/bootstrap.bundle.min.js}"
          src="../js/bootstrap.bundle.min.js">
  </script>
  <script th:src="@{/js/canvasJs/canvasjs.min.js}"
          src="../js/canvasJs/canvasjs.min.js">
  </script>
  <script th:src="@{/js/jquery-3.6.2.min.js}"
          src="../js/jquery-3.6.2.min.js">
  </script>
  <!--<script src="//dapi.kakao.com/v2/maps/sdk.js?appkey=f03997c9ab3ebbb5b7ec9d5eab20e0e3"></script>-->
  <script src="//dapi.kakao.com/v2/maps/sdk.js?appkey=f03997c9ab3ebbb5b7ec9d5eab20e0e3&libraries=services"></script>
  <style>
    a {
        color: black;
        text-decoration: none;
    }
    .nav {
        --bs-nav-link-color: none;
    }
    .field-error {
        border-color: #dc3545;
        color: #dc3545;
    }
    img {
        max-height:225px;
    }
    video {
        max-height:225px;
    }

    /* memory.html 시작 */
    .SxgK2b {
      /*background: rgba(66,66,66,.54);*/
      border-radius: 28px;
      cursor: pointer;
      position: absolute;
      /*
      top: 50%;
      margin-top: -28px;
      width: 100%;
      */
      text-align: center;
      transition: all 0.5s linear;
      left: 50%;
      margin-left: -27px;
      opacity : 0;
    }
    .Cwtbxf:hover {
	  background-color:rgba(26,115,232,.25);
	  border-radius:50%;
    }
    /* memory.html 종료 */

    /* detail.html 시작 */
    /* 배경 */
    .KJca8b {
      background-color:#000;
      position:absolute;
      left:0;
      right:0;
      top:0;
      bottom:0;
    }
    /* 메뉴 바 */
    .SmZ4Wd {
      align-items:center;
      display:flex;
      justify-content:space-between;
      background-color:transparent;
      color:#fff;
      height:64px;
      left:0;
      padding:0 14px;
      position:absolute;
      right:0;
      top:0;
      z-index:200;
      transform:translateZ(0);
      transition:all 0.5s linear;
    }
    .VfPpkd-Bz112c-LgbsSe {
      /* margin:8px 0; */
      text-align:center;
      vertical-align:bottom;
      z-index:0;
      display:inline-block;
      position:relative;
      box-sizing:border-box;
      border:none;
      outline:none;
      background-color:transparent;
      fill:currentColor;
      text-decoration:none;
      cursor:pointer;
      width:48px;
      height:48px;
      padding:12px;
      --mdc-ripple-fg-size:0x;
      --mdc-ripple-left:0;
      --mdc-ripple-top:0;
      --mdc-ripple-fg-scale:1;
      --mdc-ripple-fg-translate-end:0;
      --mdc-ripple-fg-translate-start:0;
      -webkit-tap-highlight-color:rgba(0,0,0,0);
      will-change:transform,opacity;
      transition:all 0.5s linear;
      //color:#fff;
    }
    .VfPpkd-Bz112c-LgbsSe:hover {
	  background-color:rgba(90,90,90,.25);
	  border-radius:50%;
    }
    .WpHeLc {
      position:relative;
      top:-4px;
    }
    .JUQOtc {
      fill:#fff;
    }
    .xvKqge {
      color:#fff;
      display:flex;
      flex:1 1 auto;
      justify-content:flex-end;
    }
    .c9yG5b {
      align-items: center;
      display: inline-flex;
	  transition:all 0.5s linear;
    }
    .G6iPcb {
      margin: 8px 0;
      display: inline-block;
      min-width: 0;
      vertical-align: bottom;
    }
    .O8EXO {
      color:#fff;
    }
    .yHy1rc {
      z-index:0;
    }
    /* 이미지 div */
    .VmkiKe {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        top: 0;
        overflow: hidden;
        text-align: center;
        transition: all 0.5s linear;
    }
    .VmkiKe:after {
      display:inline-block;
      height:100%;
      content:"";
      vertical-align:middle;
    }
    /* 사이드 바 */
    .sideBar {
        position:absolute;
        top:0;
        bottom:0;
        right:0;
        width:360px;
        overflow-y:auto;
        transform:translate3d(360px, 0, 0);
        transition:transform 0.5s linear;
        background-color:#fff;
    }
    .IMbeAf {
      font-family: "Google Sans",Roboto,Arial,sans-serif;
      line-height: 1.5rem;
      font-size: 1.125rem;
      letter-spacing: 0;
      font-weight: 400;
      display: flex;
      -ms-flex-pack: justify;
      align-items: center;
      -ms-flex-align: center;
      flex-direction: row-reverse;
      justify-content: flex-end;
      padding: 8px;
    }
    .zE2Vqb {
      padding: 20px 24px;
    }
    .qURWqc {
      font-family: Roboto,Arial,sans-serif;
      line-height: 1.5rem;
      font-size: 1rem;
      letter-spacing: .00625em;
      font-weight: 400;
      /* white-space: pre-wrap; */
      word-wrap: break-word;
    }
    .Mna4i {
      line-height: 1.5rem;
      position: relative;
    }
    .n4jc2d {
      padding-bottom: 1px;
      /* white-space: pre-wrap; */
      word-wrap: break-word;
    }
    .ajQY2 {
      border: none;
      border-bottom: 1px solid rgba(0,0,0,.12);
      bottom: 0;
      box-sizing: border-box;
      color: inherit;
      display: block;
      font: inherit;
      height: 100%;
      letter-spacing: inherit;
      margin: 0;
      outline: none;
      overflow: hidden;
      padding: 0;
<!--      position: absolute;-->
      resize: none;
      top: 0;
      transition: .3s cubic-bezier(.4,0,.2,1) all;
      width: 100%;
    }
    .ajQY2:focus {
      border-bottom: 1px solid rgb(66,133,244);
    }
    .wiOkb {
      color: rgb(95,99,104);
      display: flex;
      padding: 14px 24px;
      font-family: Roboto,Arial,sans-serif;
      line-height: 1rem;
      font-size: .6875rem;
      letter-spacing: .0727272727em;
      font-weight: 500;
      text-transform: uppercase;
    }
    .Kd04rd {
      position: relative;
    }
    .Kd04rd:hover {
        background-color: rgb(241,243,244);
    }
    .ffq9nc {
      display: flex;
      padding: 18px 24px;
    }
    .dNjXAc {
      height: 24px;
      min-width: 40px;
      width: 40px;
    }
    .Y0p3Ue {
      fill:rgba(0,0,0,.54);
    }
    .rCexAf {
      margin: 0;
      overflow: hidden;
    }
    .R9U8ab {
      color: rgb(60,64,67);
      word-wrap: break-word;
      font-family: Roboto,Arial,sans-serif;
      line-height: 1.5rem;
      font-size: 1rem;
      letter-spacing: .00625em;
      font-weight: 400;
    }
    .oBMhZb {
      align-items: center;
      color: rgb(95,99,104);
      display: flex;
      flex-wrap: wrap;
      margin-top: 0;
      font-family: Roboto,Arial,sans-serif;
      line-height: 1.25rem;
      font-size: .875rem;
      letter-spacing: .0142857143em;
      font-weight: 400;
    }
    .cFLCHe {
      display: block;
      background-color: #fff;
      background-position: 50% 50%;
      background-size: 360px;
      height: 360px;
    }
    /* detail.html 종료 */
  </style>
  <script>
    function checkSession() {
      let session = "[[${session.loginMember}]]";
      if (session == "") {
        window.close();
      }
    }
    function showChart(weightsArr, petName) {
      var weights = [];
      for (var i = 0; i < weightsArr.length; i++) {
        weights.push({
          x : new Date(weightsArr[i].date),
          y : weightsArr[i].weight
        });
      }
      var chart = new CanvasJS.Chart("petWeightChart",
      {
          title: {
              text: petName
          },
          axisX:{
            title: "",
            valueFormatString: "YYYY-MM-DD",
          },
          axisY: {
            title: "",
		    suffix: " kg",
		    includeZero: true
        },
        data: [{
          type: "spline",
          xValueType: "dateTime",
          xValueFormatString: "YYYY-MM-DD",
          yValueFormatString: "#,##0.## kg",
          dataPoints: weights
        }]
      });
      chart.render();
    }
    function isEmpty(data) {
      if (data == "") {
        return true;
      }

      return false;
    }
    function isSameDate(id) {
      console.log(document.getElementById(id));
      return document.getElementById(id);
    }
    function checkWeightData() {
      var form = document.weightForm;
      var dateVal = form.date.value;
      var weightVal = form.weight.value;

      if (isEmpty(dateVal)) {
        alert("[[#{NotNull.weightForm.date}]]");
        return false;
      } else if (isSameDate(dateVal)) {
        alert("[[#{existDate.weightForm.date}]]");
        return false;
      }

      if (isEmpty(weightVal)) {
        alert("[[#{NotNull.weightForm.weight}]]");
        return false;
      }

      return true;
    }
    function deleteWeight(page, text) {
      if (confirm(text)) {
        window.location.replace(page);
      }
    }
    function showImageMenu(id) {
      var parent = document.getElementById(id);
      parent.getElementsByClassName('SxgK2b')[0].style.opacity = 1;
    }
    function hideImageMenu(id) {
      var parent = document.getElementById(id);
      parent.getElementsByClassName('SxgK2b')[0].style.opacity = 0;
    }
    function showSideBar(element) {
      let className = 'sideBar';
      let sideBar = document.getElementsByClassName(className)[0];
      let topMenuName = 'SmZ4Wd';
      let topMenu = document.getElementsByClassName(topMenuName)[0];
      let imageDivName = 'VmkiKe';
      let imageDiv = document.getElementsByClassName(imageDivName)[0];
      sideBar.style.transform = 'translate3d(0, 0, 0)';
      topMenu.style.right = '360px';
      imageDiv.style.right = '360px';
      element.setAttribute('onclick', 'hideSideBar(this, "' + className + '")');
    }

    function hideSideBar(element) {
      let className = 'sideBar';
      let sideBar = document.getElementsByClassName(className)[0];
      let topMenuName = 'SmZ4Wd';
      let topMenu = document.getElementsByClassName(topMenuName)[0];
      let imageDivName = 'VmkiKe';
      let imageDiv = document.getElementsByClassName(imageDivName)[0];
      sideBar.style.transform = 'translate3d(360px, 0, 0)';
      topMenu.style.right = '0px';
      imageDiv.style.right = '0px';
      if (element === undefined) {
        element = document.getElementsByClassName('info')[0];
      }
      element.setAttribute('onclick', 'showSideBar(this, "' + className + '")');
    }
    function changeMemoryInfo(info, memoryId) {
      var json = {"memoryId" : memoryId, "info" : info}

      $.ajax({
        url : "/memories/memory/detail/update/info",
        type : "post",
        data : JSON.stringify(json),
        contentType:"application/json;charset=UTF-8",
	    async: false,
	    success : function(data) {
	      if (data == null) {
	        alert('Error');
	      }
	    },
	    error: function(xhr, status, error){
	       alert(xhr.responseText);
	    },
      });
    }
    function resize(element) {
      element.style.height = "1px";
      element.style.height = (12 + element.scrollHeight) + "px";
      console.log($(element).prop('scrollHeight'));
    }
    function showMap(gps) {
      if (gps != null) {
        var latitude = gps.latitude;
        var longitude = gps.longitude;
        showAddress(latitude, longitude);  // 주소 표시 함수
        var map = makeMap(latitude, longitude);
        drawMarker(latitude, longitude, map);
      }
    }

    function makeMap(latitude, longitude) {
        var mapContainer = document.getElementById('map'), // 지도를 표시할 div
        mapOption = {
            center: new kakao.maps.LatLng(latitude, longitude), // 지도의 중심좌표
            level: 5 // 지도의 확대 레벨
        };
        // 지도를 표시할 div와  지도 옵션으로  지도를 생성합니다
        return new kakao.maps.Map(mapContainer, mapOption);
    }

    function drawMarker(latitude, longitude, map) {
        var markerPosition  = new kakao.maps.LatLng(latitude, longitude);

        // 마커를 생성합니다
        var marker = new kakao.maps.Marker({
            position: markerPosition
        });

        // 마커가 지도 위에 표시되도록 설정합니다
        marker.setMap(map);
    }

    function showWalkMap(dataList) {
      var latitude = 37.53650277777778; // 초기값
      var longitude = 126.950225; // 초기값
      for (var i = 0; i < dataList.length; i++) {
        latitude = dataList[i].gps.latitude;
        longitude = dataList[i].gps.longitude;
      }
      var map = makeMap(latitude, longitude);
      drawMarker(latitude, longitude, map);
      console.log(dataList);
    }

    function showAddress(x, y) {
      var geocoder = new kakao.maps.services.Geocoder();

      var coord = new kakao.maps.LatLng(x, y);
      var callback = function(result, status) {
          if (status === kakao.maps.services.Status.OK) {
              var address = document.getElementById('address');
              address.innerText = result[0].address.address_name;
          }
      };

      geocoder.coord2Address(coord.getLng(), coord.getLat(), callback);
    }

    /*$(document).ready(function() {
      $('.ajQY2').keyup(function() {
        var textVal = this.value.replace(/\r?\n/g,"<br>");
        //var textVal = this.value.replaceAll(/(\n|\r\n)/g,'<br>');
        $('.n4jc2d').html(textVal);
        $('.n4jc2d').css('height', 'auto');
        $(this).height($('.n4jc2d').prop('scrollHeight'));
        console.log($('.n4jc2d').val());
        console.log($('.n4jc2d').prop('scrollHeight'));
        console.log($(this).prop('scrollHeight'));
      });
    });*/
  </script>
</head>
<body>

</body>
</html>